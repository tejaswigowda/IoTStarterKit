
<html>

<head>
  <script src='script.js'> </script>
<script>
var chart;
function start()
{
	// set date-time;

   chart = c3.generate({
       bindto: '#chart',
       data: {
          columns: [[]]
       }
    });
	setInterval(loadGraph, 30000);
}

var lastTimeStamp = 0;
function loadGraph()
{
  loadURL("./getData", function(res){
    var data = JSON.parse(res);
    currTimeStamp = data[0].ts;
    if(currTimeStamp === lastTimeStamp){
        return;
    }
    var cols = [
      ['Temp'],
      ['Humidity']
    ];

    for (var i = 0; i < 10/*data.length*/; i++){
      var row = data[i];
      cols[0].push(row.t);
      cols[1].push(row.h);
    }

    chart.load({
       columns: cols
    });
    lastTimeStamp = data[0].ts;
  });
}
</script>
</head>

<body onload='start()'>
  <h1> TEST </h1>
	<input id='fromtime' type='datetime-local' onchange='loadGraph()'>
	<select id='interval' onchange='loadGraph()'>
	  <option val='5*60*1000'> last 5 mins </option>
	  <option val='30*60*1000'> last 30 mins </option>
	  <option val='60*60*1000'> last 1 hour </option>
	  <option val='2*60*60*1000'> last 2 hours </option>
	  <option val='6*60*60*1000'> last 6 hours </option>
	  <option val='12*60*60*1000'> last 12 hours</option>
	</select>
	
	<button onclick=''loadGraph()> Refresh </button>

  <div id="chart"></div>
</body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
</html>
